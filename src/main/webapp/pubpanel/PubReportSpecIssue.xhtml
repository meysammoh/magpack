<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="#{localeBean.language}"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


<ui:composition template="/templates/breadcrumbcomp.xhtml">
    <ui:define name="content">
        <f:event listener="#{breadCrumbNav.navigateSpecIssue}" type="preRenderView"/>
        <p:panel id="IssueReportContainer" style="width:#{statistics.width};margin: auto; ">
            <h:form id="magazinefrm">
                <div id="magazinestable">
                    <p:dataTable
                            emptyMessage="#{text['no.records.found']}"
                            id="magazinesdtbl"
                            styleClass="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker"
                            var="magtblspecissue" value="#{pubUserDet.selectedCurrentMagazine}"

                            scrollable="true" rows="1"

                            tableStyle="width:100%;overflow: hidden; text-overflow: ellipsis;font-size: 0.8em;margin:0 auto;"
                            lazy="false">


                        <p:column headerText="#{text['issue.text']}">

                            <p:commandLink style="color:#269abc;"
                                           value="#{statistics.getNonFullFormatDate(magtblspecissue.magazine_tblTable.orig_issue_date)}"
                                           actionListener="#{pubUserDet.getGetIssueSelectedAndRedirectToSelectdeSpecIssuePage(magtblspecissue)}">
                            </p:commandLink>


                        </p:column>
                        <p:column headerText="#{text['reader.age.avg.text']}">

                            <h:outputText value="#{magtblspecissue.averageReaderAge}">
                                <f:convertNumber pattern="#,###,##0.00"/>
                            </h:outputText>

                        </p:column>
                        <p:column headerText="#{text['geo.hotspot.postcode.text']}">
                            <h:outputText value="#{magtblspecissue.geogrHotspotPostCode}"/>
                        </p:column>
                        <p:column headerText="#{text['page.view.avg.text']}">
                            <h:outputText value="#{magtblspecissue.averagePageViews}">
                                <f:convertNumber pattern="#,###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="#{text['page.view.total.text']}">

                            <h:outputText value="#{magtblspecissue.totalPageViews}"/>

                        </p:column>

                        <p:column headerText="#{text['adpage.view.total.text']}">

                            <h:outputText value="#{magtblspecissue.totalAdPageViews}" style="width: 72%"/>

                        </p:column>

                        <p:column headerText="#{text['reading.length.avg.text']}">

                            <h:outputText
                                    value="#{statistics.getInHHmmssFormatDouble(magtblspecissue.averageLengthPerReadingSession)}"
                                    style="width: 72%"/>

                        </p:column>

                        <p:column headerText="#{text['reading.session.total.text']}">

                            <h:outputText value="#{magtblspecissue.totalaReadingsessions}" style="width: 72%"/>

                        </p:column>

                        <p:column headerText="#{text['revenue.earned.text']}">

                            <h:outputText value="#{magtblspecissue.revenuesEarned}" style="width: 72%">
                                <f:convertNumber pattern="#,###,##0.00 â‚¬" maxIntegerDigits="10"/>
                            </h:outputText>

                        </p:column>

                        <p:column headerText="#{text['download.total.text']} / #{text['range.text']}">

                            <h:outputText value="#{magtblspecissue.totalDownloadsPerReach}" style="width: 72%"/>

                        </p:column>

                    </p:dataTable>
                </div>
                <h:panelGrid columns="1" id="chartsGridFirstRow">

                    <h:panelGrid columns="4" id="firstRowGrid">
                        <p:column id="AgeDistributionColumn">
                            <p:chart type="pie" model="#{ageChart.agePieChart}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="GeoDistributionColumn">
                            <p:chart type="pie" model="#{geoChart.geoPieChart}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="PageViewsPerWeekColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.pageViewHorizontalBarModel}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="AdPageViewsPerWeekColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.adPageViewHorizontalBarModel}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                    </h:panelGrid>


                </h:panelGrid>
                <h:panelGrid columns="1" id="chartsGridSecondRow">

                    <h:panelGrid columns="4" id="secondRowGrid">
                        <p:column id="AvgLengthPerSessionColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.averageSessionHorizental}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="totalReadingSessionsColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.totalSessionHorizental}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="totalDownloadsColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.totalDownloadsHorizental}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                        <p:column id="totalRevenuesColumn">
                            <p:chart type="bar" model="#{pageViewHorizontalChart.revenueEarnedHorizental}"
                                     style="width:100%;margin: auto;"/>
                        </p:column>
                    </h:panelGrid>

                </h:panelGrid>

                <!--<div class="limitedHeightDiv">-->
                <!--<c:forEach var="res" items="#{pubUserDet.listOfPageImageAdress}">-->
                <!--<div class="pageimage">-->
                <!--<p:graphicImage width="100%" height="100%"-->
                <!--value="#{res.key}"-->
                <!--/>-->
                <!--<h:outputText value="0%"/>-->
                <!--</div>-->
                <!--</c:forEach>-->
                <!--</div>-->

                <div class="limitedHeightDiv">
                    <c:forEach var="res" items="#{pubUserDet.listOfPageImageAdress}">
                        <div class="pageimage">
                            <p:graphicImage width="100%" height="100%"
                                            value="#{res.imagePath}"
                                    />
                            <h:outputText value="#{res.readPercent} %"/>
                        </div>
                    </c:forEach>
                </div>
                <p:remoteCommand name="uibrc" id="rcuiid2"/>
                <p:blockUI id="blockui" block="chartsGridFirstRow" trigger="rcuiid2">
                    #{text['wait.message']}<br/>
                    <p:graphicImage value="/icons/loading.gif"/>
                </p:blockUI>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>


</html>
